<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Браки и разводы</title>
    {% load static %}

    {# Подключение CSS #}
    <link rel="stylesheet" href="{% static 'css/highcharts.css'%}" type="text/css">

    {# Подключение JavaScript #}
    <script src="{% static 'js/highcharts.js' %}"></script>
    <script src="{% static 'js/exporting.js' %}"></script>
    <script src="{% static 'js/export-data.js' %}"></script>
    <script src="{% static 'js/accessibility.js' %}"></script>
</head>

<body>
<h2>Браки и разводы</h2>

<form action="" method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <input type="submit" value="Запросить">
</form>

<br>
<div class="highcharts-data-table">
<table>
    <caption>Таблица 1. Основные показатели брачности и разводимости населения</caption>
    <tr>
        <th rowspan="2">Показатель</th>
        <th rowspan="2">Единица измерения</th>
        <th colspan="3">Значения показателей</th>
    </tr>
    <tr>
        {# Комментарий #}
        {% for year in years %}
        <th>{{ year }}</th>
        {% endfor %}
    </tr>
    {% load custom_tags %}
    {% for indicator, data in data_by_indicator.items %}
    <tr>
        <td>{{ indicator }}</td>
        <td style="text-align:center;">{{ data.unit }}</td>
        {% for year in years %}
        <td style="text-align:center;">{{ data.values|get_item:year }}</td>
        {% endfor %}
    </tr>
    {% endfor %}
</table>
</div>

{# Рисуем график#}
<figure class="highcharts-figure">
    <div id="container"></div>
    <script>
    Highcharts.chart('container', {
        chart: {
            type: 'column'
        },
        title: {
            text: 'Динамика числа браков и разводов',
            align: 'left'
        },
        subtitle: {
            text:
                'Данные: <a target="_blank" ' +
                'href="https://rosstat.gov.ru/">Федеральная служба государственной статистики</a>',
            align: 'left'
        },
        xAxis: {
            categories: {{ years|safe }},
            crosshair: true,
            accessibility: {
                description: 'Countries'
            }
        },
        yAxis: {
            min: 0,
            title: {
                text: 'Человек'
            }
        },
        tooltip: {
            valueSuffix: ' человек'
        },
        plotOptions: {
            column: {
                pointPadding: 0.05,
                borderWidth: 0
            }
        },
        series: [
            {
                name: 'Город',
                data: {{ values1|safe }}
            },
            {
                name: 'Село',
                data: {{ values2|safe }}
            }
        ]
    });
    </script>

    {% comment %}
    <p class="highcharts-description">
        Число браков в городской и сельской местностях.
   </p>
    {% endcomment %}
</figure>
</body>
</html>